/**
 * @file    :   Problem G. Toxel 与字符画
 * @author  :   Tanphoon
 * @date    :   2023/05/14 21:47
 * @version :   2023/05/14 21:47
 * @link    :
 */
#include <bits/stdc++.h>
using namespace std;
using ull = unsigned long long;
const int EQUAL = 20, INF = 21;
vector<vector<string>> put(22, vector<string>(10));

void init() {
    vector<string> Big = {
        ".................................................................................",
        ".................................................................................",
        ".0000000.......1.2222222.3333333.4.....4.5555555.6666666.7777777.8888888.9999999.",
        ".0.....0.......1.......2.......3.4.....4.5.......6.............7.8.....8.9.....9.",
        ".0.....0.......1.......2.......3.4.....4.5.......6.............7.8.....8.9.....9.",
        ".0.....0.......1.2222222.3333333.4444444.5555555.6666666.......7.8888888.9999999.",
        ".0.....0.......1.2.............3.......4.......5.6.....6.......7.8.....8.......9.",
        ".0.....0.......1.2.............3.......4.......5.6.....6.......7.8.....8.......9.",
        ".0000000.......1.2222222.3333333.......4.5555555.6666666.......7.8888888.9999999.",
        ".................................................................................",

    };
    vector<string> Sml = {
        ".............................................................",
        ".00000.....1.22222.33333.4...4.55555.66666.77777.88888.99999.",
        ".0...0.....1.....2.....3.4...4.5.....6.........7.8...8.9...9.",
        ".0...0.....1.22222.33333.44444.55555.66666.....7.88888.99999.",
        ".0...0.....1.2.........3.....4.....5.6...6.....7.8...8.....9.",
        ".00000.....1.22222.33333.....4.55555.66666.....7.88888.99999.",
        ".............................................................",
        ".............................................................",
        ".............................................................",
        ".............................................................",
    };
    put[20] = {
        ".......", ".......", ".......", ".......", "=======", ".......", "=======", ".......", ".......", ".......",
    };
    put[21] = {
        ".......................", ".......................", "IIIIIII.N.....N.FFFFFFF", "...I....NN....N.F......",
        "...I....N.N...N.F......", "...I....N..N..N.FFFFFFF", "...I....N...N.N.F......", "...I....N....NN.F......",
        "IIIIIII.N.....N.F......", ".......................",
    };
    for (int i = 0; i < 10; i++)
        for (int y = 0; y < 10; y++) {
            put[i][y] = Big[y].substr(8 * i + 1, 7);
            put[i + 10][y] = Sml[y].substr(6 * i + 1, 5);
        }
}

ull pow(ull a, ull b) {
    ull res = 1;
    for (; b; b >>= 1, a = a * a)
        if (b & 1)
            res *= a;
    return res;
}
void solve() {
    ull x, y;
    scanf("%lld^{%lld}", &x, &y);
    vector<int> out;
    for (char i : to_string(x))
        out.push_back(i - '0');
    for (char i : to_string(y))
        out.push_back(i - '0' + 10);
    out.push_back(EQUAL);
    if (y * log10(x) > 18) {
        out.push_back(INF);
    } else {
        ull res = pow(x, y);
        if (res > ull(1e18)) {
            out.push_back(INF);
        } else {
            for (char i : to_string(res))
                out.push_back(i - '0');
        }
    }
    for (int y = 0; y < 10; y++) {
        cout << '.';
        for (int i : out)
            cout << put[i][y] << '.';
        cout << '\n';
    }
    cout << '\n';
}

int main() {
    init();
    int T = 1;
    cin >> T;
    while (T--)
        solve();
}
